<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Using/Specifying Risk Models • CanEpiRisk</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using/Specifying Risk Models"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CanEpiRisk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CanEpiRisk.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CanEpiRisk_Models.html">Using/Specifying Risk Models</a></li>
    <li><a class="dropdown-item" href="../articles/CanEpiRisk_ReferenceData.html">Using/Specifying Reference Data</a></li>
    <li><a class="dropdown-item" href="../articles/CanEpiRisk_RiskCalculation.html">Calculating cumulative excess risks</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using/Specifying Risk Models</h1>
            
      

      <div class="d-none name"><code>CanEpiRisk_Models.Rmd</code></div>
    </div>

    
    
<div id="installation" class="section level2">
<h2>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(CanEpiRisk)</span></code></pre></div>
</div>
<div id="overview" class="section level2">
<h2>1. Overview</h2>
<p><code>CanEpiRisk</code> supports two ways to supply risk models for
lifetime risk (CER, YLL) and related computations:</p>
<ol style="list-style-type: decimal">
<li><strong>Predefined models</strong> from the Life Span Study (LSS) of
the Japanese atomic-bomb survivors for <strong>mortality</strong> and
<strong>incidence</strong>:
<ul>
<li><code>LSS_mortality</code> (mortality)</li>
<li><code>LSS_incidence</code> (incidence)</li>
</ul></li>
<li><strong>User-specified models</strong>, provided as a list with the
components:
<ul>
<li><code>para</code>: numeric vector of parameter estimates</li>
<li><code>var</code>: variance–covariance matrix of
<code>para</code></li>
<li><code>f(beta, data, lag)</code>: function returning the ERR/EAR
given parameters <code>beta</code>, a <code>data</code> frame, and a
minimum latency <code>lag</code></li>
</ul></li>
</ol>
<p>The predefined models cover standard <strong>ERR</strong> (excess
relative rate) and <strong>EAR</strong> (excess absolute rate)
formulations for multiple cancer sites. The typical data fields expected
by the model functions are:</p>
<ul>
<li><code>dose</code> (e.g., Gy), <code>age</code> (attained age),
<code>agex</code> (age at exposure), and <code>sex</code> (1 = male, 2 =
female).</li>
</ul>
<blockquote>
<p><strong>Notes</strong> - Use <code>lag</code> to enforce a minimum
latency between exposure and attained age (e.g., 5 y for solid cancers,
2 y for leukaemia). - Model objects are organized by
<strong>site</strong> and <strong>dose–response form</strong> (e.g.,
<code>L</code> = linear, <code>LQ</code> = linear–quadratic), and each
has <code>err</code> and/or <code>ear</code> entries.</p>
</blockquote>
</div>
<div id="quick-start" class="section level2">
<h2>2. Quick start</h2>
<hr />
</div>
<div id="predefined-risk-models" class="section level2">
<h2>(1) Predefined risk models</h2>
<div id="mortality-lss" class="section level3">
<h3>Mortality (LSS)</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">names</span>(LSS_mortality)                 <span class="co"># sites with available mortality models</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;allsolid&quot;  &quot;esophagus&quot; &quot;stomach&quot;   &quot;colon&quot;     &quot;liver&quot;     &quot;lung&quot;     </span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; [7] &quot;bladder&quot;   &quot;breast&quot;    &quot;leukaemia&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">names</span>(LSS_mortality<span class="sc">$</span>allsolid)        <span class="co"># available dose–response forms for all solid</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;L&quot;  &quot;LQ&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L<span class="sc">$</span>err<span class="sc">$</span>para    <span class="co"># parameter vector (example)</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; [1] -0.861334 -0.346062 -0.857491  0.344098</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L<span class="sc">$</span>err<span class="sc">$</span>var     <span class="co"># variance–covariance matrix (example)</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;        colon10        ew30      lage70         msex</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; 1  0.014180600  0.00333207  0.01639360 -0.000677273</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; 2  0.003332070  0.00662021 -0.01588550 -0.001016880</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; 3  0.016393600 -0.01588550  0.17911000  0.003545970</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; 4 -0.000677273 -0.00101688  0.00354597  0.007714090</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L<span class="sc">$</span>err<span class="sc">$</span>f       <span class="co"># ERR function</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; function (beta, data, lag=5) {</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;               exp(beta[1])*data$dose * exp(beta[2] * (data$agex - 30)/10 + beta[3] * log(data$age/70)) *</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;            (1 + c(-1, 1)[data$sex] * beta[4]) * (data$age - data$agex &gt;= lag )</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;        }</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; &lt;bytecode: 0x0000012f7f681f58&gt;</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000012f7f682e38&gt;</span></span></code></pre></div>
<p>Plot an example (all solid, <strong>linear ERR</strong>):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot_riskmodel</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">rm    =</span> LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;LSS all solid cancer mortality — Linear&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">leg_pos =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.95</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="C:/Users/furukawa/Dropbox/CanEpiRisk/docs/articles/CanEpiRisk_Models_files/figure-html/mortality-plot-1.png" width="700" /></p>
</div>
<div id="incidence-lss" class="section level3">
<h3>Incidence (LSS)</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">names</span>(LSS_incidence)                 <span class="co"># sites with available incidence models</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;allsolid&quot;  &quot;leukaemia&quot; &quot;esophagus&quot; &quot;stomach&quot;   &quot;colon&quot;     &quot;liver&quot;    </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;lung&quot;      &quot;prostate&quot;  &quot;pancreas&quot;  &quot;bladder&quot;   &quot;breast&quot;    &quot;thyroid&quot;  </span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [13] &quot;brainCNS&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">names</span>(LSS_incidence<span class="sc">$</span>allsolid)        <span class="co"># available dose–response forms for all solid</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;L&quot;  &quot;LQ&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>LSS_incidence<span class="sc">$</span>allsolid<span class="sc">$</span>L<span class="sc">$</span>err<span class="sc">$</span>para    <span class="co"># parameter vector (example)</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;      sexMale:dgy    sexFemale:dgy   lage70:sexMale lage70:sexFemale </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;        0.2731771        0.6398698       -2.5640146       -1.3783097 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;              e30       hidoseTRUE </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;       -0.2330051       -0.2761703</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>LSS_incidence<span class="sc">$</span>allsolid<span class="sc">$</span>L<span class="sc">$</span>err<span class="sc">$</span>var     <span class="co"># variance–covariance matrix (example)</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt;                    sexMale:dgy sexFemale:dgy lage70:sexMale lage70:sexFemale</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; sexMale:dgy       0.0021308300   0.000526540   0.0119066187    -0.0015145731</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; sexFemale:dgy     0.0005265400   0.003944061  -0.0019637448     0.0057283111</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; lage70:sexMale    0.0119066187  -0.001963745   0.2072085784     0.0090031922</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; lage70:sexFemale -0.0015145731   0.005728311   0.0090031922     0.0708425868</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; e30               0.0008522796   0.001378741  -0.0046736366    -0.0053350872</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; hidoseTRUE       -0.0012531791  -0.002191058  -0.0002535854     0.0004417784</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt;                            e30    hidoseTRUE</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; sexMale:dgy       0.0008522796 -0.0012531791</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; sexFemale:dgy     0.0013787414 -0.0021910581</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; lage70:sexMale   -0.0046736366 -0.0002535854</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; lage70:sexFemale -0.0053350872  0.0004417784</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; e30               0.0028724210 -0.0003010759</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; hidoseTRUE       -0.0003010759  0.0373994998</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>LSS_incidence<span class="sc">$</span>allsolid<span class="sc">$</span>L<span class="sc">$</span>err<span class="sc">$</span>f       <span class="co"># ERR function</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; function( beta, data, lag=5 ){  exp( beta[5]*(data$agex-30)/10 ) *</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt;         (  (data$sex==1)*(beta[1]*data$dose) * exp(beta[3]*log(data$age/70)) </span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt;          + (data$sex==2)*(beta[2]*data$dose) * exp(beta[4]*log(data$age/70)) )  * (data$age - data$agex &gt;= lag )</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt;            }</span></span></code></pre></div>
<p>Plot an example (all solid, <strong>linear ERR</strong>):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot_riskmodel</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">rm    =</span> LSS_incidence<span class="sc">$</span>allsolid<span class="sc">$</span>L,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;LSS all solid cancer incidence — Linear&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">leg_pos =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.95</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; Warning: [1m[22mRemoved 5 rows containing missing values or values outside the scale range</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="C:/Users/furukawa/Dropbox/CanEpiRisk/docs/articles/CanEpiRisk_Models_files/figure-html/incidence-plot-1.png" width="700" /></p>
</div>
</div>
<div id="user-specified-risk-models" class="section level2">
<h2>(2) User-specified risk models</h2>
<p>You can define a model for any endpoint by supplying a list with the
required components. Below is a <strong>template</strong> for a linear
ERR model using the common covariates; adapt as needed.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>my_err_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, data, <span class="at">lag =</span> <span class="dv">5</span>) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="co"># beta: parameter vector</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="co"># data: data.frame with columns dose, age, agex, sex (1=male, 2=female)</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="co"># lag : minimum latency (years)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="co"># Example linear in dose with modifiers:</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta[<span class="dv">1</span>]) <span class="sc">*</span> data<span class="sc">$</span>dose <span class="sc">*</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>         <span class="fu">exp</span>(beta[<span class="dv">2</span>] <span class="sc">*</span> (data<span class="sc">$</span>agex <span class="sc">-</span> <span class="dv">30</span>) <span class="sc">/</span> <span class="dv">10</span> <span class="sc">+</span> beta[<span class="dv">3</span>] <span class="sc">*</span> <span class="fu">log</span>(data<span class="sc">$</span>age <span class="sc">/</span> <span class="dv">70</span>)) <span class="sc">*</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>         (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)[data<span class="sc">$</span>sex] <span class="sc">*</span> beta[<span class="dv">4</span>]) <span class="sc">*</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>         (data<span class="sc">$</span>age <span class="sc">-</span> data<span class="sc">$</span>agex <span class="sc">&gt;=</span> lag)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>}</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>my_model <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="at">para =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.86</span>, <span class="sc">-</span><span class="fl">0.35</span>, <span class="sc">-</span><span class="fl">0.86</span>, <span class="fl">0.34</span>),   <span class="co"># example values</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="at">var  =</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.18</span>, <span class="fl">0.008</span>)),<span class="co"># example diagonal VCOV</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="at">err  =</span> <span class="fu">list</span>(<span class="at">para =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.86</span>, <span class="sc">-</span><span class="fl">0.35</span>, <span class="sc">-</span><span class="fl">0.86</span>, <span class="fl">0.34</span>),</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>              <span class="at">var  =</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.18</span>, <span class="fl">0.008</span>)),</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>              <span class="at">f    =</span> my_err_fun)</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="co"># optionally: ear = list(para=..., var=..., f=...)</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>)</span></code></pre></div>
<blockquote>
<p><strong>Tip</strong>: Keep the parameter order in <code>para</code>
consistent with how you index inside <code>f()</code>.</p>
</blockquote>
</div>
<div id="example" class="section level2">
<h2>3. Example</h2>
<p>As an example, the following shows how to specify the risk models on
derived from the INWORKS cohort for mortality from all solid cancer
(Richardson et al., 2015) and from leukaemia (Leuraud et al., 2015).
Note that the uncertainty in the only risk model parameter (ERR/Gy) is
specified by the 95% confidence interval, instead of the
variance-covariance matrix in the LSS risk models objects.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>INWORKS_mortality <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>INWORKS_mortality<span class="sc">$</span>allsolid <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>INWORKS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>     <span class="at">err=</span><span class="fu">list</span>(</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>       <span class="at">para=</span><span class="fu">c</span>(<span class="fl">0.47</span>),                  <span class="co"># ERR/Gy=0.47 (90% CI: 0.18,0.79)  </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>       <span class="at">ci=</span> <span class="fu">c</span>(<span class="fl">0.1392403</span>, <span class="fl">0.8521128</span>),   <span class="co">#  95% CI coverted from 90%CI by Weibull approx.</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>       <span class="at">f=</span><span class="cf">function</span> (beta, data, <span class="at">lag=</span><span class="dv">10</span>) {</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>           beta[<span class="dv">1</span>] <span class="sc">*</span> data<span class="sc">$</span>dose  <span class="sc">*</span> (data<span class="sc">$</span>age <span class="sc">-</span> data<span class="sc">$</span>agex <span class="sc">&gt;=</span> lag )</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>       }</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>       ),</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>      <span class="at">ear=</span><span class="fu">list</span>(    <span class="co"># dummry object</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>       <span class="at">para=</span><span class="fu">c</span>(<span class="fl">4.8</span><span class="sc">/</span><span class="dv">10000</span>),</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>       <span class="at">ci=</span> <span class="fu">c</span>(<span class="fl">0.1068428</span>, <span class="fl">12.5703871</span>)<span class="sc">/</span><span class="dv">10000</span>,</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>       <span class="at">f=</span><span class="cf">function</span> (beta, data, <span class="at">lag=</span><span class="dv">10</span>) {</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>           beta[<span class="dv">1</span>] <span class="sc">*</span> data<span class="sc">$</span>dose  <span class="sc">*</span> (data<span class="sc">$</span>age <span class="sc">-</span> data<span class="sc">$</span>agex <span class="sc">&gt;=</span> lag )</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>       } </span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>       )</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a> </span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>  )</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>INWORKS_mortality<span class="sc">$</span>leukaemia<span class="sc">$</span>L <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>     <span class="at">err=</span><span class="fu">list</span>(</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>       <span class="at">para=</span><span class="fu">c</span>(<span class="fl">2.96</span>),                         <span class="co"># ERR/Gy=2.96 (90% CI: 1.17, 5.21) </span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>       <span class="at">ci=</span> <span class="fu">c</span>(<span class="fl">0.8664</span>, <span class="fl">5.6940</span>),</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>       <span class="at">f=</span><span class="cf">function</span> (beta, data, <span class="at">lag=</span><span class="dv">2</span>) {</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>           beta[<span class="dv">1</span>] <span class="sc">*</span> data<span class="sc">$</span>dose  <span class="sc">*</span> (data<span class="sc">$</span>age <span class="sc">-</span> data<span class="sc">$</span>agex <span class="sc">&gt;=</span> lag )</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>       }</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>       ),</span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>      <span class="at">ear=</span><span class="fu">list</span>(    <span class="co"># dummry object</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>       <span class="at">para=</span><span class="fu">c</span>(<span class="fl">2.25</span><span class="sc">/</span><span class="dv">10000</span>),</span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>       <span class="at">ci=</span><span class="fu">c</span>(<span class="fl">0.5064054</span>, <span class="fl">4.4914628</span>)<span class="sc">/</span><span class="dv">10000</span>,</span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>       <span class="at">f=</span><span class="cf">function</span> (beta, data, <span class="at">lag=</span><span class="dv">2</span>) {</span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a>           beta[<span class="dv">1</span>] <span class="sc">*</span> data<span class="sc">$</span>dose  <span class="sc">*</span> (data<span class="sc">$</span>age <span class="sc">-</span> data<span class="sc">$</span>agex <span class="sc">&gt;=</span> lag )</span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a>       } </span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>       )</span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a>  )</span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a>INWORKS_mortality</span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt; $allsolid</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="co">#&gt; $allsolid$L</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$err</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$err$para</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="co">#&gt; [1] 0.47</span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$err$ci</span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a><span class="co">#&gt; [1] 0.1392403 0.8521128</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$err$f</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a><span class="co">#&gt; function (beta, data, lag = 10) </span></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span id="cb7-52"><a href="#cb7-52" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb7-53"><a href="#cb7-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-54"><a href="#cb7-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-55"><a href="#cb7-55" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$ear</span></span>
<span id="cb7-56"><a href="#cb7-56" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$ear$para</span></span>
<span id="cb7-57"><a href="#cb7-57" tabindex="-1"></a><span class="co">#&gt; [1] 0.00048</span></span>
<span id="cb7-58"><a href="#cb7-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-59"><a href="#cb7-59" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$ear$ci</span></span>
<span id="cb7-60"><a href="#cb7-60" tabindex="-1"></a><span class="co">#&gt; [1] 1.068428e-05 1.257039e-03</span></span>
<span id="cb7-61"><a href="#cb7-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-62"><a href="#cb7-62" tabindex="-1"></a><span class="co">#&gt; $allsolid$L$ear$f</span></span>
<span id="cb7-63"><a href="#cb7-63" tabindex="-1"></a><span class="co">#&gt; function (beta, data, lag = 10) </span></span>
<span id="cb7-64"><a href="#cb7-64" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb7-65"><a href="#cb7-65" tabindex="-1"></a><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span id="cb7-66"><a href="#cb7-66" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb7-67"><a href="#cb7-67" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-68"><a href="#cb7-68" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-69"><a href="#cb7-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-70"><a href="#cb7-70" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-71"><a href="#cb7-71" tabindex="-1"></a><span class="co">#&gt; $leukaemia</span></span>
<span id="cb7-72"><a href="#cb7-72" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L</span></span>
<span id="cb7-73"><a href="#cb7-73" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$err</span></span>
<span id="cb7-74"><a href="#cb7-74" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$err$para</span></span>
<span id="cb7-75"><a href="#cb7-75" tabindex="-1"></a><span class="co">#&gt; [1] 2.96</span></span>
<span id="cb7-76"><a href="#cb7-76" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-77"><a href="#cb7-77" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$err$ci</span></span>
<span id="cb7-78"><a href="#cb7-78" tabindex="-1"></a><span class="co">#&gt; [1] 0.8664 5.6940</span></span>
<span id="cb7-79"><a href="#cb7-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-80"><a href="#cb7-80" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$err$f</span></span>
<span id="cb7-81"><a href="#cb7-81" tabindex="-1"></a><span class="co">#&gt; function (beta, data, lag = 2) </span></span>
<span id="cb7-82"><a href="#cb7-82" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb7-83"><a href="#cb7-83" tabindex="-1"></a><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span id="cb7-84"><a href="#cb7-84" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb7-85"><a href="#cb7-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-86"><a href="#cb7-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-87"><a href="#cb7-87" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$ear</span></span>
<span id="cb7-88"><a href="#cb7-88" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$ear$para</span></span>
<span id="cb7-89"><a href="#cb7-89" tabindex="-1"></a><span class="co">#&gt; [1] 0.000225</span></span>
<span id="cb7-90"><a href="#cb7-90" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-91"><a href="#cb7-91" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$ear$ci</span></span>
<span id="cb7-92"><a href="#cb7-92" tabindex="-1"></a><span class="co">#&gt; [1] 5.064054e-05 4.491463e-04</span></span>
<span id="cb7-93"><a href="#cb7-93" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-94"><a href="#cb7-94" tabindex="-1"></a><span class="co">#&gt; $leukaemia$L$ear$f</span></span>
<span id="cb7-95"><a href="#cb7-95" tabindex="-1"></a><span class="co">#&gt; function (beta, data, lag = 2) </span></span>
<span id="cb7-96"><a href="#cb7-96" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb7-97"><a href="#cb7-97" tabindex="-1"></a><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span id="cb7-98"><a href="#cb7-98" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb7-99"><a href="#cb7-99" tabindex="-1"></a></span>
<span id="cb7-100"><a href="#cb7-100" tabindex="-1"></a><span class="co"># Plotting solid cancer mortality risk, male, </span></span>
<span id="cb7-101"><a href="#cb7-101" tabindex="-1"></a><span class="co">#          6.7(100/15)mGy at ages 30-45, followed up to age 60, LSS-L, LSS-LQ and INWORKS models</span></span>
<span id="cb7-102"><a href="#cb7-102" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" tabindex="-1"></a>exp4 <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">agex=</span><span class="dv">30</span><span class="sc">:</span><span class="dv">44</span><span class="fl">+0.5</span>, <span class="at">doseGy=</span><span class="fu">rep</span>(<span class="fl">0.1</span><span class="sc">/</span><span class="dv">15</span>,<span class="dv">15</span>), <span class="at">sex=</span><span class="dv">1</span> )   <span class="co"># Exposure scenario</span></span>
<span id="cb7-104"><a href="#cb7-104" tabindex="-1"></a>opt4_err <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">maxage=</span><span class="dv">90</span>, <span class="at">err_wgt=</span><span class="dv">1</span> )    <span class="co"># for ERR transfer</span></span>
<span id="cb7-105"><a href="#cb7-105" tabindex="-1"></a>opt4_ear <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">maxage=</span><span class="dv">90</span>, <span class="at">err_wgt=</span><span class="dv">0</span> )    <span class="co"># for EAR transfer</span></span>
<span id="cb7-106"><a href="#cb7-106" tabindex="-1"></a></span>
<span id="cb7-107"><a href="#cb7-107" tabindex="-1"></a>lss_err_L  <span class="ot">&lt;-</span> <span class="fu">Comp_Exrisk</span>( <span class="at">exposure=</span>exp4, <span class="at">riskmodel=</span>LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L,     <span class="at">option=</span>opt4_err )</span>
<span id="cb7-108"><a href="#cb7-108" tabindex="-1"></a>lss_err_LQ <span class="ot">&lt;-</span> <span class="fu">Comp_Exrisk</span>( <span class="at">exposure=</span>exp4, <span class="at">riskmodel=</span>LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>LQ,    <span class="at">option=</span>opt4_err )</span>
<span id="cb7-109"><a href="#cb7-109" tabindex="-1"></a>inw_err_L  <span class="ot">&lt;-</span> <span class="fu">Comp_Exrisk</span>( <span class="at">exposure=</span>exp4, <span class="at">riskmodel=</span>INWORKS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L, <span class="at">option=</span>opt4_err )</span>
<span id="cb7-110"><a href="#cb7-110" tabindex="-1"></a></span>
<span id="cb7-111"><a href="#cb7-111" tabindex="-1"></a>lss_ear_L  <span class="ot">&lt;-</span> <span class="fu">Comp_Exrisk</span>( <span class="at">exposure=</span>exp4, <span class="at">riskmodel=</span>LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L,     <span class="at">option=</span>opt4_ear, <span class="at">per=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> )</span>
<span id="cb7-112"><a href="#cb7-112" tabindex="-1"></a>lss_ear_LQ <span class="ot">&lt;-</span> <span class="fu">Comp_Exrisk</span>( <span class="at">exposure=</span>exp4, <span class="at">riskmodel=</span>LSS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>LQ,    <span class="at">option=</span>opt4_ear, <span class="at">per=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> )</span>
<span id="cb7-113"><a href="#cb7-113" tabindex="-1"></a>inw_ear_L  <span class="ot">&lt;-</span> <span class="fu">Comp_Exrisk</span>( <span class="at">exposure=</span>exp4, <span class="at">riskmodel=</span>INWORKS_mortality<span class="sc">$</span>allsolid<span class="sc">$</span>L, <span class="at">option=</span>opt4_ear, <span class="at">per=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> )</span>
<span id="cb7-114"><a href="#cb7-114" tabindex="-1"></a></span>
<span id="cb7-115"><a href="#cb7-115" tabindex="-1"></a><span class="fu">plot</span>( <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">90</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Excess relative rate&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;age (years)&quot;</span> )</span>
<span id="cb7-116"><a href="#cb7-116" tabindex="-1"></a><span class="fu">lines</span>( lss_err_L, <span class="at">lty=</span><span class="dv">2</span> )</span>
<span id="cb7-117"><a href="#cb7-117" tabindex="-1"></a><span class="fu">lines</span>( lss_err_LQ, <span class="at">lty=</span><span class="dv">3</span> )</span>
<span id="cb7-118"><a href="#cb7-118" tabindex="-1"></a><span class="fu">lines</span>( inw_err_L )</span></code></pre></div>
<p><img src="C:/Users/furukawa/Dropbox/CanEpiRisk/docs/articles/CanEpiRisk_Models_files/figure-html/unnamed-chunk-2-1.png" width="700" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">plot</span>( <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">90</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Excess absolute rate (cases per 10,000 person years)&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;age (years)&quot;</span> )</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">lines</span>( lss_ear_L, <span class="at">lty=</span><span class="dv">2</span> )</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">lines</span>( lss_ear_LQ, <span class="at">lty=</span><span class="dv">3</span> )</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">lines</span>( inw_ear_L )</span></code></pre></div>
<p><img src="C:/Users/furukawa/Dropbox/CanEpiRisk/docs/articles/CanEpiRisk_Models_files/figure-html/unnamed-chunk-2-2.png" width="700" /></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Richardson, D.B., E. Cardis, R.D. Daniels et al. Risk of cancer from
occupational exposure to ionising radiation: retrospective cohort study
of workers in France, the United Kingdom, and the United States
(INWORKS). BMJ 351: h5359 (2015).</p>
<p>Richardson, D.B., K. Leuraud, D. Laurier et al. Cancer mortality
after low dose exposure to ionising radiation in workers in France, the
United Kingdom, and the United States (INWORKS): cohort study. BMJ 382:
e074520 (2023).</p>
<p>Leuraud, K., D.B. Richardson, E. Cardis et al. Ionising radiation and
risk of death from leukaemia and lymphoma in radiation-monitored workers
(INWORKS): an international cohort study. Lancet Haematol 2(7): e276-281
(2015).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyoji Furukawa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>
