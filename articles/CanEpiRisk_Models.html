<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using/Specifying Risk Models • CanEpiRisk</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using/Specifying Risk Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CanEpiRisk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/CanEpiRisk.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/CanEpiRisk_Models.html">Using/Specifying Risk Models</a></li>
    <li><a class="dropdown-item" href="../articles/CanEpiRisk_ReferenceData.html">Using/Specifying Reference Data</a></li>
    <li><a class="dropdown-item" href="../articles/CanEpiRisk_RiskCalculation.html">Calculating cumulative excess risks</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using/Specifying Risk Models</h1>
            
      

      <div class="d-none name"><code>CanEpiRisk_Models.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kyojifurukawa.github.io/CanEpiRisk/">CanEpiRisk</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overview">1. Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>CanEpiRisk</code> supports two ways to supply risk models for
lifetime risk (CER, YLL) and related computations:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Predefined models</strong> from the Life Span Study (LSS) of
the Japanese atomic-bomb survivors for <strong>mortality</strong> and
<strong>incidence</strong>:
<ul>
<li>
<code>LSS_mortality</code> (mortality)</li>
<li>
<code>LSS_incidence</code> (incidence)</li>
</ul>
</li>
<li>
<strong>User-specified models</strong>, provided as a list with the
components:
<ul>
<li>
<code>para</code>: numeric vector of parameter estimates</li>
<li>
<code>var</code>: variance–covariance matrix of
<code>para</code>
</li>
<li>
<code>f(beta, data, lag)</code>: function returning the ERR/EAR
given parameters <code>beta</code>, a <code>data</code> frame, and a
minimum latency <code>lag</code>
</li>
</ul>
</li>
</ol>
<p>The predefined models cover standard <strong>ERR</strong> (excess
relative rate) and <strong>EAR</strong> (excess absolute rate)
formulations for multiple cancer sites. The typical data fields expected
by the model functions are:</p>
<ul>
<li>
<code>dose</code> (e.g., Gy), <code>age</code> (attained age),
<code>agex</code> (age at exposure), and <code>sex</code> (1 = male, 2 =
female).</li>
</ul>
<blockquote>
<p><strong>Notes</strong> - Use <code>lag</code> to enforce a minimum
latency between exposure and attained age (e.g., 5 y for solid cancers,
2 y for leukaemia). - Model objects are organized by
<strong>site</strong> and <strong>dose–response form</strong> (e.g.,
<code>L</code> = linear, <code>LQ</code> = linear–quadratic), and each
has <code>err</code> and/or <code>ear</code> entries.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="quick-start">2. Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<hr>
</div>
<div class="section level2">
<h2 id="predefined-risk-models">(1) Predefined risk models<a class="anchor" aria-label="anchor" href="#predefined-risk-models"></a>
</h2>
<div class="section level3">
<h3 id="mortality-lss">Mortality (LSS)<a class="anchor" aria-label="anchor" href="#mortality-lss"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">LSS_mortality</span><span class="op">)</span>                 <span class="co"># sites with available mortality models</span></span>
<span><span class="co">#&gt; [1] "allsolid"  "esophagus" "stomach"   "colon"     "liver"     "lung"     </span></span>
<span><span class="co">#&gt; [7] "bladder"   "breast"    "leukaemia"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">)</span>        <span class="co"># available dose–response forms for all solid</span></span>
<span><span class="co">#&gt; [1] "L"  "LQ"</span></span>
<span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span><span class="op">$</span><span class="va">err</span><span class="op">$</span><span class="va">para</span>    <span class="co"># parameter vector (example)</span></span>
<span><span class="co">#&gt; [1] -0.861334 -0.346062 -0.857491  0.344098</span></span>
<span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span><span class="op">$</span><span class="va">err</span><span class="op">$</span><span class="va">var</span>     <span class="co"># variance–covariance matrix (example)</span></span>
<span><span class="co">#&gt;        colon10        ew30      lage70         msex</span></span>
<span><span class="co">#&gt; 1  0.014180600  0.00333207  0.01639360 -0.000677273</span></span>
<span><span class="co">#&gt; 2  0.003332070  0.00662021 -0.01588550 -0.001016880</span></span>
<span><span class="co">#&gt; 3  0.016393600 -0.01588550  0.17911000  0.003545970</span></span>
<span><span class="co">#&gt; 4 -0.000677273 -0.00101688  0.00354597  0.007714090</span></span>
<span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span><span class="op">$</span><span class="va">err</span><span class="op">$</span><span class="va">f</span>       <span class="co"># ERR function</span></span>
<span><span class="co">#&gt; function (beta, data, lag=5) {</span></span>
<span><span class="co">#&gt;               exp(beta[1])*data$dose * exp(beta[2] * (data$agex - 30)/10 + beta[3] * log(data$age/70)) *</span></span>
<span><span class="co">#&gt;            (1 + c(-1, 1)[data$sex] * beta[4]) * (data$age - data$agex &gt;= lag )</span></span>
<span><span class="co">#&gt;        }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55b4aa5d8eb8&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x55b4aa5d5f68&gt;</span></span></code></pre></div>
<p>Plot an example (all solid, <strong>linear ERR</strong>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_riskmodel.html">plot_riskmodel</a></span><span class="op">(</span></span>
<span>  rm    <span class="op">=</span> <span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"LSS all solid cancer mortality — Linear"</span>,</span>
<span>  leg_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="CanEpiRisk_Models_files/figure-html/mortality-plot-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="incidence-lss">Incidence (LSS)<a class="anchor" aria-label="anchor" href="#incidence-lss"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">LSS_incidence</span><span class="op">)</span>                 <span class="co"># sites with available incidence models</span></span>
<span><span class="co">#&gt;  [1] "allsolid"  "leukaemia" "esophagus" "stomach"   "colon"     "liver"    </span></span>
<span><span class="co">#&gt;  [7] "lung"      "prostate"  "pancreas"  "bladder"   "breast"    "thyroid"  </span></span>
<span><span class="co">#&gt; [13] "brainCNS"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">LSS_incidence</span><span class="op">$</span><span class="va">allsolid</span><span class="op">)</span>        <span class="co"># available dose–response forms for all solid</span></span>
<span><span class="co">#&gt; [1] "L"  "LQ"</span></span>
<span><span class="va">LSS_incidence</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span><span class="op">$</span><span class="va">err</span><span class="op">$</span><span class="va">para</span>    <span class="co"># parameter vector (example)</span></span>
<span><span class="co">#&gt;      sexMale:dgy    sexFemale:dgy   lage70:sexMale lage70:sexFemale </span></span>
<span><span class="co">#&gt;        0.2731771        0.6398698       -2.5640146       -1.3783097 </span></span>
<span><span class="co">#&gt;              e30       hidoseTRUE </span></span>
<span><span class="co">#&gt;       -0.2330051       -0.2761703</span></span>
<span><span class="va">LSS_incidence</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span><span class="op">$</span><span class="va">err</span><span class="op">$</span><span class="va">var</span>     <span class="co"># variance–covariance matrix (example)</span></span>
<span><span class="co">#&gt;                    sexMale:dgy sexFemale:dgy lage70:sexMale lage70:sexFemale</span></span>
<span><span class="co">#&gt; sexMale:dgy       0.0021308300   0.000526540   0.0119066187    -0.0015145731</span></span>
<span><span class="co">#&gt; sexFemale:dgy     0.0005265400   0.003944061  -0.0019637448     0.0057283111</span></span>
<span><span class="co">#&gt; lage70:sexMale    0.0119066187  -0.001963745   0.2072085784     0.0090031922</span></span>
<span><span class="co">#&gt; lage70:sexFemale -0.0015145731   0.005728311   0.0090031922     0.0708425868</span></span>
<span><span class="co">#&gt; e30               0.0008522796   0.001378741  -0.0046736366    -0.0053350872</span></span>
<span><span class="co">#&gt; hidoseTRUE       -0.0012531791  -0.002191058  -0.0002535854     0.0004417784</span></span>
<span><span class="co">#&gt;                            e30    hidoseTRUE</span></span>
<span><span class="co">#&gt; sexMale:dgy       0.0008522796 -0.0012531791</span></span>
<span><span class="co">#&gt; sexFemale:dgy     0.0013787414 -0.0021910581</span></span>
<span><span class="co">#&gt; lage70:sexMale   -0.0046736366 -0.0002535854</span></span>
<span><span class="co">#&gt; lage70:sexFemale -0.0053350872  0.0004417784</span></span>
<span><span class="co">#&gt; e30               0.0028724210 -0.0003010759</span></span>
<span><span class="co">#&gt; hidoseTRUE       -0.0003010759  0.0373994998</span></span>
<span><span class="va">LSS_incidence</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span><span class="op">$</span><span class="va">err</span><span class="op">$</span><span class="va">f</span>       <span class="co"># ERR function</span></span>
<span><span class="co">#&gt; function( beta, data, lag=5 ){  exp( beta[5]*(data$agex-30)/10 ) *</span></span>
<span><span class="co">#&gt;         (  (data$sex==1)*(beta[1]*data$dose) * exp(beta[3]*log(data$age/70)) </span></span>
<span><span class="co">#&gt;          + (data$sex==2)*(beta[2]*data$dose) * exp(beta[4]*log(data$age/70)) )  * (data$age - data$agex &gt;= lag )</span></span>
<span><span class="co">#&gt;            }</span></span></code></pre></div>
<p>Plot an example (all solid, <strong>linear ERR</strong>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_riskmodel.html">plot_riskmodel</a></span><span class="op">(</span></span>
<span>  rm    <span class="op">=</span> <span class="va">LSS_incidence</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"LSS all solid cancer incidence — Linear"</span>,</span>
<span>  leg_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="CanEpiRisk_Models_files/figure-html/incidence-plot-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="user-specified-risk-models">(2) User-specified risk models<a class="anchor" aria-label="anchor" href="#user-specified-risk-models"></a>
</h2>
<p>You can define a model for any endpoint by supplying a list with the
required components. Below is a <strong>template</strong> for a linear
ERR model using the common covariates; adapt as needed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_err_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta</span>, <span class="va">data</span>, <span class="va">lag</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># beta: parameter vector</span></span>
<span>  <span class="co"># data: data.frame with columns dose, age, agex, sex (1=male, 2=female)</span></span>
<span>  <span class="co"># lag : minimum latency (years)</span></span>
<span>  <span class="co"># Example linear in dose with modifiers:</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">data</span><span class="op">$</span><span class="va">dose</span> <span class="op">*</span></span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">agex</span> <span class="op">-</span> <span class="fl">30</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">age</span> <span class="op">/</span> <span class="fl">70</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span></span>
<span>         <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">sex</span><span class="op">]</span> <span class="op">*</span> <span class="va">beta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span></span>
<span>         <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">agex</span> <span class="op">&gt;=</span> <span class="va">lag</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">my_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.86</span>, <span class="op">-</span><span class="fl">0.35</span>, <span class="op">-</span><span class="fl">0.86</span>, <span class="fl">0.34</span><span class="op">)</span>,   <span class="co"># example values</span></span>
<span>  var  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.18</span>, <span class="fl">0.008</span><span class="op">)</span><span class="op">)</span>,<span class="co"># example diagonal VCOV</span></span>
<span>  err  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.86</span>, <span class="op">-</span><span class="fl">0.35</span>, <span class="op">-</span><span class="fl">0.86</span>, <span class="fl">0.34</span><span class="op">)</span>,</span>
<span>              var  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.18</span>, <span class="fl">0.008</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              f    <span class="op">=</span> <span class="va">my_err_fun</span><span class="op">)</span></span>
<span>  <span class="co"># optionally: ear = list(para=..., var=..., f=...)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Tip</strong>: Keep the parameter order in <code>para</code>
consistent with how you index inside <code>f()</code>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="example">3. Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>As an example, the following shows how to specify the risk models on
derived from the INWORKS cohort for mortality from all solid cancer
(Richardson et al., 2015) and from leukaemia (Leuraud et al., 2015).
Note that the uncertainty in the only risk model parameter (ERR/Gy) is
specified by the 95% confidence interval, instead of the
variance-covariance matrix in the LSS risk models objects.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">INWORKS_mortality</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">INWORKS_mortality</span><span class="op">$</span><span class="va">allsolid</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">INWORKS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     err<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       para<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.47</span><span class="op">)</span>,                  <span class="co"># ERR/Gy=0.47 (90% CI: 0.18,0.79)  </span></span>
<span>       ci<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1392403</span>, <span class="fl">0.8521128</span><span class="op">)</span>,   <span class="co">#  95% CI coverted from 90%CI by Weibull approx.</span></span>
<span>       f<span class="op">=</span><span class="kw">function</span> <span class="op">(</span><span class="va">beta</span>, <span class="va">data</span>, <span class="va">lag</span><span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">data</span><span class="op">$</span><span class="va">dose</span>  <span class="op">*</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">agex</span> <span class="op">&gt;=</span> <span class="va">lag</span> <span class="op">)</span></span>
<span>       <span class="op">}</span></span>
<span>       <span class="op">)</span>,</span>
<span>      ear<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>    <span class="co"># dummry object</span></span>
<span>       para<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.8</span><span class="op">/</span><span class="fl">10000</span><span class="op">)</span>,</span>
<span>       ci<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1068428</span>, <span class="fl">12.5703871</span><span class="op">)</span><span class="op">/</span><span class="fl">10000</span>,</span>
<span>       f<span class="op">=</span><span class="kw">function</span> <span class="op">(</span><span class="va">beta</span>, <span class="va">data</span>, <span class="va">lag</span><span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">data</span><span class="op">$</span><span class="va">dose</span>  <span class="op">*</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">agex</span> <span class="op">&gt;=</span> <span class="va">lag</span> <span class="op">)</span></span>
<span>       <span class="op">}</span> </span>
<span>       <span class="op">)</span></span>
<span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">INWORKS_mortality</span><span class="op">$</span><span class="va">leukaemia</span><span class="op">$</span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     err<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       para<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.96</span><span class="op">)</span>,                         <span class="co"># ERR/Gy=2.96 (90% CI: 1.17, 5.21) </span></span>
<span>       ci<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8664</span>, <span class="fl">5.6940</span><span class="op">)</span>,</span>
<span>       f<span class="op">=</span><span class="kw">function</span> <span class="op">(</span><span class="va">beta</span>, <span class="va">data</span>, <span class="va">lag</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">data</span><span class="op">$</span><span class="va">dose</span>  <span class="op">*</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">agex</span> <span class="op">&gt;=</span> <span class="va">lag</span> <span class="op">)</span></span>
<span>       <span class="op">}</span></span>
<span>       <span class="op">)</span>,</span>
<span>      ear<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>    <span class="co"># dummry object</span></span>
<span>       para<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.25</span><span class="op">/</span><span class="fl">10000</span><span class="op">)</span>,</span>
<span>       ci<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5064054</span>, <span class="fl">4.4914628</span><span class="op">)</span><span class="op">/</span><span class="fl">10000</span>,</span>
<span>       f<span class="op">=</span><span class="kw">function</span> <span class="op">(</span><span class="va">beta</span>, <span class="va">data</span>, <span class="va">lag</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">data</span><span class="op">$</span><span class="va">dose</span>  <span class="op">*</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">agex</span> <span class="op">&gt;=</span> <span class="va">lag</span> <span class="op">)</span></span>
<span>       <span class="op">}</span> </span>
<span>       <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">INWORKS_mortality</span></span>
<span><span class="co">#&gt; $allsolid</span></span>
<span><span class="co">#&gt; $allsolid$L</span></span>
<span><span class="co">#&gt; $allsolid$L$err</span></span>
<span><span class="co">#&gt; $allsolid$L$err$para</span></span>
<span><span class="co">#&gt; [1] 0.47</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $allsolid$L$err$ci</span></span>
<span><span class="co">#&gt; [1] 0.1392403 0.8521128</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $allsolid$L$err$f</span></span>
<span><span class="co">#&gt; function (beta, data, lag = 10) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $allsolid$L$ear</span></span>
<span><span class="co">#&gt; $allsolid$L$ear$para</span></span>
<span><span class="co">#&gt; [1] 0.00048</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $allsolid$L$ear$ci</span></span>
<span><span class="co">#&gt; [1] 1.068428e-05 1.257039e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $allsolid$L$ear$f</span></span>
<span><span class="co">#&gt; function (beta, data, lag = 10) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $leukaemia</span></span>
<span><span class="co">#&gt; $leukaemia$L</span></span>
<span><span class="co">#&gt; $leukaemia$L$err</span></span>
<span><span class="co">#&gt; $leukaemia$L$err$para</span></span>
<span><span class="co">#&gt; [1] 2.96</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $leukaemia$L$err$ci</span></span>
<span><span class="co">#&gt; [1] 0.8664 5.6940</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $leukaemia$L$err$f</span></span>
<span><span class="co">#&gt; function (beta, data, lag = 2) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $leukaemia$L$ear</span></span>
<span><span class="co">#&gt; $leukaemia$L$ear$para</span></span>
<span><span class="co">#&gt; [1] 0.000225</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $leukaemia$L$ear$ci</span></span>
<span><span class="co">#&gt; [1] 5.064054e-05 4.491463e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $leukaemia$L$ear$f</span></span>
<span><span class="co">#&gt; function (beta, data, lag = 2) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     beta[1] * data$dose * (data$age - data$agex &gt;= lag)</span></span>
<span><span class="co">#&gt; }</span></span>
<span></span>
<span><span class="co"># Plotting solid cancer mortality risk, male, </span></span>
<span><span class="co">#          6.7(100/15)mGy at ages 30-45, followed up to age 60, LSS-L, LSS-LQ and INWORKS models</span></span>
<span></span>
<span><span class="va">exp4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> agex<span class="op">=</span><span class="fl">30</span><span class="op">:</span><span class="fl">44</span><span class="op">+</span><span class="fl">0.5</span>, doseGy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">/</span><span class="fl">15</span>,<span class="fl">15</span><span class="op">)</span>, sex<span class="op">=</span><span class="fl">1</span> <span class="op">)</span>   <span class="co"># Exposure scenario</span></span>
<span><span class="va">opt4_err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> maxage<span class="op">=</span><span class="fl">90</span>, err_wgt<span class="op">=</span><span class="fl">1</span> <span class="op">)</span>    <span class="co"># for ERR transfer</span></span>
<span><span class="va">opt4_ear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> maxage<span class="op">=</span><span class="fl">90</span>, err_wgt<span class="op">=</span><span class="fl">0</span> <span class="op">)</span>    <span class="co"># for EAR transfer</span></span>
<span></span>
<span><span class="va">lss_err_L</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Comp_Exrisk.html">Comp_Exrisk</a></span><span class="op">(</span> exposure<span class="op">=</span><span class="va">exp4</span>, riskmodel<span class="op">=</span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span>,     option<span class="op">=</span><span class="va">opt4_err</span> <span class="op">)</span></span>
<span><span class="va">lss_err_LQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Comp_Exrisk.html">Comp_Exrisk</a></span><span class="op">(</span> exposure<span class="op">=</span><span class="va">exp4</span>, riskmodel<span class="op">=</span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">LQ</span>,    option<span class="op">=</span><span class="va">opt4_err</span> <span class="op">)</span></span>
<span><span class="va">inw_err_L</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Comp_Exrisk.html">Comp_Exrisk</a></span><span class="op">(</span> exposure<span class="op">=</span><span class="va">exp4</span>, riskmodel<span class="op">=</span><span class="va">INWORKS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span>, option<span class="op">=</span><span class="va">opt4_err</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">lss_ear_L</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Comp_Exrisk.html">Comp_Exrisk</a></span><span class="op">(</span> exposure<span class="op">=</span><span class="va">exp4</span>, riskmodel<span class="op">=</span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span>,     option<span class="op">=</span><span class="va">opt4_ear</span>, per<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span> <span class="op">)</span></span>
<span><span class="va">lss_ear_LQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Comp_Exrisk.html">Comp_Exrisk</a></span><span class="op">(</span> exposure<span class="op">=</span><span class="va">exp4</span>, riskmodel<span class="op">=</span><span class="va">LSS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">LQ</span>,    option<span class="op">=</span><span class="va">opt4_ear</span>, per<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span> <span class="op">)</span></span>
<span><span class="va">inw_ear_L</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Comp_Exrisk.html">Comp_Exrisk</a></span><span class="op">(</span> exposure<span class="op">=</span><span class="va">exp4</span>, riskmodel<span class="op">=</span><span class="va">INWORKS_mortality</span><span class="op">$</span><span class="va">allsolid</span><span class="op">$</span><span class="va">L</span>, option<span class="op">=</span><span class="va">opt4_ear</span>, per<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">90</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"n"</span>, ylab<span class="op">=</span><span class="st">"Excess relative rate"</span>, xlab<span class="op">=</span><span class="st">"age (years)"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span> <span class="va">lss_err_L</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span> <span class="va">lss_err_LQ</span>, lty<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span> <span class="va">inw_err_L</span> <span class="op">)</span></span></code></pre></div>
<p><img src="CanEpiRisk_Models_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">90</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"n"</span>, ylab<span class="op">=</span><span class="st">"Excess absolute rate (cases per 10,000 person years)"</span>, xlab<span class="op">=</span><span class="st">"age (years)"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span> <span class="va">lss_ear_L</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span> <span class="va">lss_ear_LQ</span>, lty<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span> <span class="va">inw_ear_L</span> <span class="op">)</span></span></code></pre></div>
<p><img src="CanEpiRisk_Models_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Richardson, D.B., E. Cardis, R.D. Daniels et al. Risk of cancer from
occupational exposure to ionising radiation: retrospective cohort study
of workers in France, the United Kingdom, and the United States
(INWORKS). BMJ 351: h5359 (2015).</p>
<p>Richardson, D.B., K. Leuraud, D. Laurier et al. Cancer mortality
after low dose exposure to ionising radiation in workers in France, the
United Kingdom, and the United States (INWORKS): cohort study. BMJ 382:
e074520 (2023).</p>
<p>Leuraud, K., D.B. Richardson, E. Cardis et al. Ionising radiation and
risk of death from leukaemia and lymphoma in radiation-monitored workers
(INWORKS): an international cohort study. Lancet Haematol 2(7): e276-281
(2015).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyoji Furukawa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
