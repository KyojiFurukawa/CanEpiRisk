% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CER.R
\name{population_LAR}
\alias{population_LAR}
\title{population_LAR: Population-averaged Lifetime Attributable Risk}
\usage{
population_LAR(
  dsGy,
  reference,
  riskmodel,
  agex = 1:8 * 10 - 5,
  PER = 10000,
  nmc = 10000
)
}
\arguments{
\item{dsGy}{Numeric scalar. Radiation \strong{dose} in Gy (or Sv if your model is parameterized
accordingly). Must be nonnegative.}

\item{reference}{List describing the target \strong{reference population}, with components:
\itemize{
\item \code{baseline} — data frame of site-specific baseline \strong{incidence or mortality}
rates (per person-year) over ages 1–100, with columns \code{age}, \code{male}, \code{female}.
\item \code{mortality} — data frame of \strong{all-cause mortality} (same structure/age grid).
\item \code{agedist} — data frame or vector with the \strong{population age distribution} used
to average risks across ages (e.g., by single year or grouped ages).
}
All three components must refer to the \strong{same region/population} and share consistent
sex coding.}

\item{riskmodel}{List defining the radiation \strong{risk model}. Typically contains
sublists for ERR and/or EAR:
\itemize{
\item \code{err} / \code{ear} — each is a list with:
\itemize{
\item \code{para} — numeric vector of model parameters;
\item \code{var} — parameter variance–covariance matrix (for multi-parameter models), \emph{or}
\code{ci} — length-2 95\\% bounds for one-parameter models;
\item \code{f} — function of the form \code{f(beta, data, lag)} returning age-specific
excess risk given parameters and data (dose, ages, sex).
}
}
See package examples (e.g., \code{LSS_mortality$allsolid$L}, \code{LSS_incidence$leukaemia$LQ}).}

\item{agex}{Numeric vector of \strong{ages at exposure} (midpoints for grouped categories).
Default is \code{1:8 * 10 - 5} (i.e., 5, 15, …, 75) representing 0–10, 10–20, …, 70–80.}

\item{PER}{Integer scaling factor for reporting results \emph{per} \code{PER} persons.
Default \code{10000} (i.e., cases per 10,000 persons).}

\item{nmc}{Integer Monte Carlo sample size for uncertainty propagation. Default \code{10000}.}
}
\value{
A \strong{list} with components for each transfer model present (typically \code{$err} and \code{$ear}).
Each component is a data frame with one row per exposure age category (rows named by
\code{agex}) plus an \code{all} row, and columns:
\itemize{
\item \code{male}, \code{male_lo}, \code{male_up}
\item \code{female}, \code{female_lo}, \code{female_up}
\item \code{all}, \code{all_lo}, \code{all_up}
}
Values are LAR \strong{per \code{PER} persons}.
}
\description{
Compute \strong{population-averaged lifetime attributable risk (LAR)} due to radiation
exposure, aggregating over a population age distribution and sex-specific baseline
rates. The function combines user-specified excess risk models (ERR/EAR) with
site-specific baseline incidence/mortality and all-cause mortality to produce
age-category summaries and overall totals, with uncertainty from Monte Carlo
sampling.
}
\details{
Let \code{agedist} denote the population age distribution (by single-year or grouped
ages) and \code{baseline}/\code{mortality} denote site-specific baseline rates and
all-cause mortality for the same region/population and sex coding. For each
age-at-exposure category in \code{agex}, \code{population_LAR()} evaluates LAR under
the supplied risk model(s) and then averages across the age structure, returning
sex-specific estimates and an \code{all}-sex average. Uncertainty is obtained by
drawing model parameters either from a variance–covariance matrix (\code{var}) or,
in one-parameter models, from 95\% confidence bounds (\code{ci}) when provided.

Results are reported \strong{per \code{PER} persons} (default: per 10,000). The default
\code{agex = 1:8 * 10 - 5} corresponds to midpoint ages 5, 15, …, 75, i.e.,
exposure categories 0–10, 10–20, …, 70–80 years, matching the examples in the
package reference.
}
\section{Units & Alignment}{

Doses must be in Gy (or consistent with your model). Ensure \code{baseline} and
\code{mortality} share the same age grid (typically 1–100) and sex coding, and that
\code{agedist} corresponds to the same population.
}

\examples{
set.seed(100)
# Default package data: LSS-derived models and WHO-like regional rates
# Example 1: All solid cancer mortality, Region 1, dose = 0.1 Gy
ref1 <- list(
  baseline  = Mortality[[1]]$allsolid,   # site-specific baseline mortality
  mortality = Mortality[[1]]$allcause,   # all-cause mortality
  agedist   = agedist_rgn[[1]]           # population age distribution
)
mod1 <- LSS_mortality$allsolid$L         # linear ERR model (LSS)
out1 <- population_LAR(dsGy = 0.1, reference = ref1, riskmodel = mod1)
out1$err   # per 10,000 persons by default

# Example 2: Leukaemia incidence, Region 4, dose = 0.1 Gy, LQ model
ref2 <- list(
  baseline  = Incidence[[4]]$leukaemia,
  mortality = Mortality[[4]]$allcause,
  agedist   = agedist_rgn[[4]]
)
mod2 <- LSS_incidence$leukaemia$LQ
out2 <- population_LAR(dsGy = 0.1, reference = ref2, riskmodel = mod2, PER = 10000, nmc = 10000)
out2$err

}
\seealso{
\code{\link{CER}}, \code{\link{plot_agedist}}, \code{\link{population_YLL}}, \code{\link{YLL}}
}
