% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CER.R
\name{CER}
\alias{CER}
\title{CER: Calculating Cumulative Excess Risks}
\usage{
CER(exposure, reference, riskmodel, option)
}
\arguments{
\item{exposure}{list. Exposure scenario with components:
\itemize{
\item \code{agex}: age(s) at exposure (scalar or vector).
\item \code{doseGy}: dose(s) in gray (Gy); same length as \code{agex} if vectorized.
\item \code{sex}: sex indicator (\code{1} = male, \code{2} = female).
}}

\item{reference}{list. Baseline reference data for the same population/region with:
\itemize{
\item \code{baseline}: data frame of site-specific baseline rates (incidence or mortality),
with columns \code{age}, \code{male}, \code{female} on ages 1:100.
\item \code{mortality}: data frame of all-cause mortality (same columns/age grid).
}}

\item{riskmodel}{list. Radiation risk model definition with sublists for
\emph{excess relative risk} (ERR) and \emph{excess absolute risk} (EAR), e.g.:
\itemize{
\item \code{err}/\code{ear}: each a list containing
\code{para} (numeric parameter vector),
\code{var} (variance–covariance matrix) \emph{or} \code{ci} (length-2 95\\% CI for
1-parameter models), and
\code{f} (function of the form \code{f(beta, data, lag)} returning age-specific excess risk).
}}

\item{option}{list. Optional settings:
\itemize{
\item \code{maxage}: maximum attained age for accumulation (e.g., \code{100}).
\item \code{err_wgt}: weight to blend ERR vs EAR (\code{1} = pure ERR; \code{0} = pure EAR;
intermediate values allowed).
\item \code{n_mcsamp}: Monte Carlo sample size for uncertainty propagation (e.g., \code{10000}).
\item \code{alpha}: significance level for interval estimation (default \code{0.05}).
}}
}
\value{
A named numeric vector with point and interval summaries of cumulative excess risk,
typically including:
\itemize{
\item \code{mle}: point estimate,
\item \code{mean}, \code{median}: Monte Carlo summaries,
\item \code{ci.2.5\%}, \code{ci.97.5\%}: 95\% interval bounds.
}
Values are per person; multiply by \code{1e4} or \code{1e5} to report per 10,000 or 100,000.
}
\description{
Compute the \strong{cumulative excess risk (CER)} attributable to radiation exposure for an
individual scenario or cohort, integrating excess risks over age up to a specified
maximum while accounting for competing all-cause mortality and model uncertainty.
This is the core engine for lifetime risk estimation in \strong{CanEpiRisk}.
:contentReference[oaicite:0]{index=0}
}
\details{
Calculating Cumulative Excess Risks (CER)

The function integrates age-specific excess risks implied by the supplied
ERR/EAR model(s) across the attained-age grid (typically ages 1–100). When
\code{n_mcsamp > 1}, parameter uncertainty is propagated via Monte Carlo sampling
using either the model variance–covariance matrix (\code{var}) or a 95\% CI (\code{ci})
for 1-parameter models. For protracted exposures (vectorized \code{agex}/\code{doseGy}),
contributions are summed across exposure segments. Baseline site-specific rates
and all-cause mortality must correspond to the same population/region and share
the same age grid and sex coding.
}
\section{Units & Alignment}{

Doses must be in Gy. Ensure \code{baseline} and \code{mortality} tables are from the same
population/region and aligned on age (1–100) and sex coding. :contentReference[oaicite:1]{index=1}
}

\examples{
set.seed(100)
# Example 1: All-solid cancer mortality (Region 1), female, 0.1 Gy at age 15
exp1 <- list(agex = 15, doseGy = 0.1, sex = 2)
ref1 <- list(
  baseline  = Mortality[[1]]$allsolid,
  mortality = Mortality[[1]]$allcause
)
mod1 <- LSS_mortality$allsolid$L
opt1 <- list(maxage = 100, err_wgt = 1, n_mcsamp = 10000)

CER(exposure = exp1, reference = ref1, riskmodel = mod1, option = opt1) * 10000

# Example 2: Leukaemia incidence (Region 4), male, 100 mGy evenly across ages 30–45
exp2 <- list(agex = 30:44 + 0.5, doseGy = rep(0.1/15, 15), sex = 1)
ref2 <- list(
  baseline  = Incidence[[4]]$leukaemia,
  mortality = Mortality[[4]]$allcause
)
mod2 <- LSS_incidence$leukaemia$LQ
opt2 <- list(maxage = 60, err_wgt = 0, n_mcsamp = 10000)

CER(exposure = exp2, reference = ref2, riskmodel = mod2, option = opt2) * 10000


}
\seealso{
\link{population_LAR}, \link{YLL}
}
